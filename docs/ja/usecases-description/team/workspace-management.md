# 複数ワークスペースを作成・管理する

## 1. ユースケース名
複数ワークスペースを作成・管理する

## 2. アクター（実行者）
- **主アクター：** 組織管理者
- **副アクター：** Hexabase.AIシステム、チームメンバー、Kubernetesクラスター

## 3. 事前条件
- 組織とチームが設定済みである
- 組織管理者が組織管理権限を持っている
- 環境分離戦略（開発、ステージング）が計画されている
- 専用ノードリソースが利用可能である

## 4. 成功シナリオ（基本フロー）
1. 組織管理者が組織ダッシュボードの「ワークスペース」セクションにアクセスする
2. 組織管理者が「新しいワークスペース作成」ボタンをクリックする
3. システムがワークスペース作成ウィザードを表示する
4. 組織管理者がワークスペース名（例：`SaaS-Product-Dev`）を入力する
5. 組織管理者がワークスペースの用途（開発環境）を選択する
6. 組織管理者がリソースクォータ（CPU、メモリ、ストレージ）を設定する
7. 組織管理者が「ワークスペース作成」ボタンをクリックする
8. システムがKubernetesネームスペースを作成し、リソースクォータを適用する
9. 組織管理者がチームメンバーの割り当て画面に移動する
10. 組織管理者が開発者を選択し、`developer`権限を付与する
11. 組織管理者がDevOpsエンジニアに`workspace-admin`権限を付与する
12. システムが権限設定を適用し、メンバーにアクセス権を付与する
13. 組織管理者が同じ手順で2つ目のワークスペース（`SaaS-Product-Staging`）を作成する
14. 組織管理者がステージング用により高いリソースクォータを設定する
15. システムが両方のワークスペースの作成完了を確認する
16. 組織管理者が「専用ノード管理」画面に移動する
17. 組織管理者が専用ノードをプロビジョニングする
18. システムが専用ノードを作成し、ワークスペース間で共有可能に設定する

## 5. 代替シナリオ（代替フロー）
**5a. リソースクォータ超過**
- 6a. 設定したリソースクォータが組織の利用可能リソースを超過する
- 6b. システムが制限超過のエラーメッセージを表示する
- 6c. 組織管理者がリソース配分を調整する
- 6d. または既存ワークスペースのクォータを見直す

**5b. ワークスペース名重複**
- 4a. 入力したワークスペース名が組織内で既に使用されている
- 4b. システムが重複エラーと代替案を表示する
- 4c. 組織管理者が別のワークスペース名を入力する

**5c. 専用ノードプロビジョニング失敗**
- 17a. 専用ノードの作成中にインフラエラーが発生する
- 17b. システムがエラー詳細とトラブルシューティング情報を表示する
- 17c. 組織管理者がサポートに連絡するか、後で再試行する

**5d. 権限付与エラー**
- 11a. チームメンバーへの権限付与が失敗する
- 11b. システムが権限エラーメッセージを表示する
- 11c. 組織管理者がメンバーの組織所属状況を確認する
- 11d. 組織管理者が権限設定を再実行する

## 6. 事後条件
- 開発用ワークスペース（`SaaS-Product-Dev`）が作成されている
- ステージング用ワークスペース（`SaaS-Product-Staging`）が作成されている
- 各ワークスペースに適切なリソースクォータが設定されている
- チームメンバーが各ワークスペースに適切な権限で割り当てられている
- 専用ノードがプロビジョニングされ、ワークスペース間で共有可能になっている
- 環境分離が実現されている
- 各ワークスペースが独立してモニタリングされている 