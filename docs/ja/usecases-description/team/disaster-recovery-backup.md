# 災害復旧（DR）とバックアップのユーザー操作

## 1. ユースケース名
災害復旧（DR）とバックアップのユーザー操作

## 2. アクター（実行者）
- **主アクター：** 組織管理者、DevOpsエンジニア
- **副アクター：** Hexabase.AIシステム、バックアップサービス、ストレージシステム

## 3. 事前条件
- チームプランが設定されている
- 重要なアプリケーションとデータベースが稼働している
- 組織管理者が適切な権限を持っている
- バックアップストレージが設定されている

## 4. 成功シナリオ（基本フロー）
1. 組織管理者が組織ダッシュボードの「バックアップ & DR」セクションにアクセスする
2. システムが現在のバックアップ状況と設定オプションを表示する
3. 組織管理者が「災害復旧計画設定」ボタンをクリックする
4. システムがDR設定ウィザードを表示する
5. 組織管理者が重要なデータベースボリューム（PostgreSQL、MySQL等）を選択する
6. 組織管理者がバックアップ頻度（日次、週次）を設定する
7. 組織管理者が地理冗長バックアップストレージの場所を選択する
8. 組織管理者が「バックアップ計画作成」ボタンをクリックする
9. システムが自動バックアップスケジュールを作成し、適用する
10. システムが初回フルバックアップを実行する
11. 組織管理者がバックアップ実行状況をリアルタイムで監視する
12. システムがバックアップ完了通知を送信する
13. 組織管理者が「復旧テスト」機能にアクセスする
14. 組織管理者がテスト用の復旧シナリオを選択する
15. システムが隔離された環境でデータ復旧テストを実行する
16. システムが復旧テスト結果とデータ整合性レポートを表示する
17. 組織管理者がバックアップ設定とDR計画を確認・承認する

## 5. 代替シナリオ（代替フロー）
**5a. バックアップ実行失敗**
- 10a. 初回バックアップの実行中にストレージ容量不足エラーが発生する
- 10b. システムがエラー詳細とストレージ使用量を表示する
- 10c. 組織管理者がストレージプランをアップグレードする
- 10d. または不要なバックアップデータを削除する
- 10e. システムがバックアップ処理を再実行する

**5b. 地理冗長バックアップ設定エラー**
- 7a. 選択した地理的場所でのバックアップストレージが利用不可能になる
- 7b. システムが代替バックアップ場所の選択肢を表示する
- 7c. 組織管理者が別の地理的場所を選択する
- 7d. システムが新しい場所でのバックアップ設定を構成する

**5c. 復旧テスト失敗**
- 15a. データ復旧テスト中にデータ整合性エラーが検出される
- 15b. システムがエラー詳細と推奨対処法を表示する
- 15c. 組織管理者がバックアップ設定を見直す
- 15d. 組織管理者がより頻繁なバックアップスケジュールを設定する
- 15e. システムが改善されたバックアップ計画を再適用する

**5d. 実際の災害時復旧操作**
- 災害発生時の緊急復旧フロー：
- 1d. 組織管理者が「緊急復旧」ボタンをクリックする
- 2d. システムが最新のバックアップデータを特定する
- 3d. 組織管理者が復旧対象のワークスペースとサービスを選択する
- 4d. システムが緊急復旧処理を開始する
- 5d. システムが復旧進行状況をリアルタイムで表示する
- 6d. システムが復旧完了とデータ整合性確認を通知する

**5e. バックアップ設定変更**
- 6a. 組織管理者が既存のバックアップ頻度を変更したい
- 6b. 組織管理者が「バックアップ設定変更」ボタンをクリックする
- 6c. システムが設定変更の影響範囲を表示する
- 6d. 組織管理者が変更を確認・承認する
- 6e. システムが新しいバックアップスケジュールを適用する

## 6. 事後条件
- 基本的な災害復旧計画が構成されている
- 重要なデータベースボリュームの日次自動バックアップが設定されている
- バックアップデータが地理冗長性のある安全な場所に保存されている
- 復旧テストが正常に完了し、データ整合性が確認されている
- 災害発生時の復旧手順が文書化され、アクセス可能になっている
- バックアップ監視とアラート機能が有効になっている
- 組織メンバーがバックアップ状況を確認できる
- 緊急時の迅速な復旧が可能な体制が整っている 