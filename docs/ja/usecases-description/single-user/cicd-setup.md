# CI/CDパイプラインを設定する

## 1. ユースケース名
CI/CDパイプラインを設定する

## 2. アクター（実行者）
- **主アクター：** 個人開発者
- **副アクター：** GitHubリポジトリ、Hexabase.AIシステム、コンテナレジストリ

## 3. 事前条件
- 開発者がワークスペースを所有している
- GitHubリポジトリにアプリケーションコードが存在する
- 開発者がGitHubリポジトリへの管理者権限を持っている
- Hexabase.AIアカウントとGitHubアカウントが連携可能な状態である

## 4. 成功シナリオ（基本フロー）
1. 開発者がHexabase.AIダッシュボードのCI/CD設定画面にアクセスする
2. 開発者が「GitHubリポジトリを接続」ボタンをクリックする
3. システムがGitHub認証画面にリダイレクトする
4. 開発者がGitHubでアクセス許可を承認する
5. システムが利用可能なリポジトリ一覧を表示する
6. 開発者が対象のリポジトリを選択する
7. システムがCI/CDテンプレート選択画面を表示する
8. 開発者が「Node.js + React」テンプレートを選択する
9. システムがパイプライン設定の詳細画面を表示する
10. 開発者がビルド設定とデプロイメント設定を確認・調整する
11. 開発者が「パイプライン作成」ボタンをクリックする
12. システムがWebhookをGitHubリポジトリに設定する
13. システムが初回パイプライン実行を開始する
14. システムがパイプライン実行状況を表示する

## 5. 代替シナリオ（代替フロー）
**5a. GitHub認証失敗**
- 4a. GitHub認証でエラーが発生する
- 4b. システムがエラーメッセージを表示する
- 4c. 開発者がGitHubのアクセス権限を確認する
- 4d. 開発者が再認証を試行する

**5b. 初回ビルド失敗**
- 13a. 初回パイプライン実行でビルドエラーが発生する
- 13b. システムが詳細なエラーログを表示する
- 13c. 開発者がビルド設定を修正する
- 13d. 開発者が手動でパイプラインを再実行する

**5c. リポジトリアクセス権限不足**
- 6a. 選択したリポジトリへのアクセス権限が不足している
- 6b. システムが権限不足のメッセージを表示する
- 6c. 開発者がリポジトリの権限設定を確認・調整する

## 6. 事後条件
- GitHubリポジトリとHexabase.AIが連携されている
- CI/CDパイプラインが設定されている
- `git push`でパイプラインが自動実行される設定になっている
- ステージング環境への自動デプロイメントが有効になっている
- パイプライン実行履歴が確認可能になっている 