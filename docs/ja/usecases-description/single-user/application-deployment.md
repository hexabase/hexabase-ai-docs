# アプリケーションをデプロイする

## 1. ユースケース名
アプリケーションをデプロイする

## 2. アクター（実行者）
- **主アクター：** 個人開発者
- **副アクター：** HKS CLI、Hexabase.AIシステム、コンテナレジストリ

## 3. 事前条件
- 開発者がワークスペースを所有している
- アプリケーション（Node.jsバックエンド、Reactフロントエンド）が開発済みである
- HKS CLIがインストールされ、認証設定が完了している
- Dockerコンテナイメージが作成されている

## 4. 成功シナリオ（基本フロー）
1. 開発者がHKS CLIを使用してデプロイメントコマンドを実行する
2. システムがアプリケーションコンテナを共有ノードプールに配置する
3. システムがコンテナイメージをプライベートレジストリからプルする
4. システムがKubernetesデプロイメントとサービスを作成する
5. 開発者がデータベースが必要であることを確認する
6. 開発者がHKSマーケットプレイスからPostgreSQLインスタンスを選択する
7. システムが永続ストレージボリュームを作成し、PostgreSQLをプロビジョニングする
8. システムがアプリケーションとデータベース間の接続を設定する
9. システムがアプリケーションのURLとアクセス情報を表示する
10. 開発者がアプリケーションの動作を確認する

## 5. 代替シナリオ（代替フロー）
**5a. デプロイメント失敗**
- 4a. コンテナイメージのプルに失敗する
- 4b. システムがエラーログを表示する
- 4c. 開発者がイメージの存在とアクセス権限を確認する
- 4d. 開発者が修正後、再デプロイを実行する

**5b. リソース不足**
- 2a. 共有ノードプールにリソースが不足している
- 2b. システムが待機状態のメッセージを表示する
- 2c. システムがリソースが利用可能になり次第、自動的にデプロイメントを継続する

**5c. ストレージ制限超過**
- 7a. 永続ストレージの制限を超過している
- 7b. システムが制限超過のエラーメッセージを表示する
- 7c. 開発者が不要なデータを削除するか、プランをアップグレードする

## 6. 事後条件
- アプリケーションが共有ノードプールで実行されている
- PostgreSQLデータベースがプロビジョニングされ、アプリケーションと接続されている
- アプリケーションがパブリックURLでアクセス可能になっている
- リソース使用量がモニタリングされている 