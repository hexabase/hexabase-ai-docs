# 初回ログイン後のワークスペースセットアップ

## 1. ユースケース名

初回ログイン後のワークスペースセットアップ

## 2. アクター（実行者）

- **主アクター：** 個人開発者(以下、開発者)
- **副アクター：** Hexabase.AIシステム(以下、システム)

## 3. 事前条件

- インターネット接続が利用可能である
- 開発者はブラウザまたはHKS CLIが利用可能である
- 開発者はHexabase.AIアカウントにログインし、組織が作成済みである
  - 初回ログインと組織の作成は[IdPでHexabase.AIに初回ログインする](../common/external-auth-signup.md)を参照

## 4. 成功シナリオ（基本フロー）

### 4a. 成功シナリオ（基本フロー）:ブラウザー使用時

1. システムはユーザがワークスペースを作成済みかチェック、ワークスペースが存在しない場合はワークスペースの作成を促す画面を表示
   - ワークスペースが存在する場合は 4a.4 "ダッシュボード表示へ遷移"に遷移
2. 開発者が名前やプランなど必要な情報を指定し、ワークスペースを作成する
3. システムがワークスペースを作成する
4. システムはダッシュボード画面を表示する
   - ワークスペースの名前、利用可能なリソース、クォータなどが確認できる
5. 開発者はワークスペースの情報を確認する

### 4b. 成功シナリオ（基本フロー）:HKS CLI使用時

1. 開発者はワークスペースを作成するコマンドを実行する
2. 開発者はHKS CLI上に必要な情報を入力する
3. システムがワークスペースを作成し、完了メッセージを出力する
4. 開発者はワークスペースの確認コマンドからワークスペースの情報を確認する
   - 名前、利用可能なリソース、クォータなどが確認できる

## 5a. 代替シナリオ（代替フロー）:ブラウザー使用時

**5a.1 開発者がワークスペース未作成で他の機能にアクセスしようとする**

- 4a.2a. システムはブラウザーワークスペース作成画面に遷移させ、先にワークスペースを作成するように促す
- 4a.2b. 開発者はワークスペースを作成する

**5a.2 ワークスペース作成失敗**

- 4a.3a. システムがアクセス集中により、リソースが不足しワークスペース作成が失敗する
- 4a.3b. システムは開発者に"しばらく待ってから再試行してください"メッセージを表示する
- 4a.3c. 開発者は一定時間待った後に再試行する、解決しない場合はシステムサポートに連絡する

## 5b. 代替シナリオ（代替フロー）:HKS CLI使用時

**5b.1 開発者がワークスペース未作成で他の機能にアクセスするコマンドを実行する**

- 4b.2a. システムは開発者のコマンドを中断し、先にワークスペースを作るように促す
- 4b.2b. 開発者はワークスペースを作成するコマンドを実行する

**5b.2 ワークスペース作成失敗**

- 4b.3a. システムがアクセス集中により、リソースが不足しワークスペース作成が失敗する
- 4b.3b. システムは"しばらく待ってから再試行してください"メッセージを出力する
- 4b.3c. 開発者は一定時間待った後に再試行する、解決しない場合はシステムサポートに連絡する

## 6. 事後条件

- システム内に開発者専用の隔離されたワークスペースが作成されている
- 開発者がワークスペースの情報にアクセスできる状態になっている
  - ブラウザー:ワークスペースのダッシュボード画面にアクセス可能
  - HKS CLI:ワークスペースの情報取得コマンドが使用可能
- システムでプライベートKubernetesネームスペースが割り当てられ、リソースクォータと制限が設定されている

## 7. 仕様未定／要検討

- 5a.1 TODO:ブラウザー使用時、開発者がワークスペース未作成の状態で他の機能にアクセスしようとしたとき
  - 他の機能にアクセスできないようにリンクやボタンを非活性状態にするか？
  - モーダルダイアログを表示し必ずワークスペースを作成するようにするか？
- 4a.4/4b.4 TODO:ワークスペースの情報で確認可能な内容を決める
